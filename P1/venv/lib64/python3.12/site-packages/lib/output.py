import json

from lib.enums import StdOut
from lib.types import AutobadgerResult


def print_stdout(result: AutobadgerResult):
    return print(json.dumps(result.to_dict(), indent=2))


def json_stdout(result: AutobadgerResult):
    with open("score.json", "w") as file:
        json.dump(result.to_dict(), file, indent=2)
        print("Saved results to score.json")


class AutobadgerOutput:
    def __init__(self, stdout: StdOut):
        self.out = self._get_stdout(stdout)

    @staticmethod
    def _get_stdout(stdout: StdOut):
        if stdout == StdOut.PRINT:
            return print_stdout
        else:
            return json_stdout

    def __call__(self, *args, **kwargs):
        return self.out(*args, **kwargs)
